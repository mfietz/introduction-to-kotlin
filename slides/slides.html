<!DOCTYPE html>
<html>
  <head>
    <title>Introduction to Kotlin - For Java Developers</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="fonts.css">
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <textarea id="source">

layout: true
class: white-text
name: cover
background-image: url(images/kotlin-tower.jpg)
background-size: cover
---
layout: true
class: divider
name: divider
background-color: #26546D
---
layout: true
class: divider
name: sub-divider
background-color: #70AD47
---

template: cover

<div class="footer bottombox" style="background-color: #2C4B60;">
  <h1>Introduction to <img src="images/kotlin.png" height="42"><br>For Java Developers</h1>
  <h3>Martin Fietz</h3>
</div>
<div class="footer bottombox">
  <h1>Introduction to <img src="images/kotlin.png" height="42"><br>For Java Developers</h1>
  <h3>Martin Fietz</h3>
</div>

---

layout: true

---

# First Taste¹

```
data class Person(
        val name: String,
        val age: Int? = null
)

fun main(args: Array<String>) {
    val people = listOf(Person("Alice"), Person("Bob", 42))
    println("The oldest person is ${people.oldest()}}")
}

private fun List<Person>.oldest() = this.maxBy { it.age ?: 0 }
```

prints
```diff
The oldest person is Person(name=Bob, age=42)}
```
<div class="footnote">
<hr>
<span class="footnote">¹ Adapted from <i>Kotlin in Action</i></span>
</div>

---

count: false

# First Taste¹

```
data class Person(
        val name: String,
        val age: Int? = null
)

fun main(args: Array<String>) {
*   val people = listOf(Person("Alice"), Person("Bob", age = 42))
    println("The oldest person is ${people.oldest()}}")
}

private fun List<Person>.oldest() = this.maxBy { it.age ?: 0 }
```

prints
```diff
The oldest person is Person(name=Bob, age=42)}
```
<div class="footnote">
<hr>
<span class="footnote">¹ Adapted from <i>Kotlin in Action</i></span>
</div>

---


count: false

# First Taste¹

```
data class Person(
        val name: String,
        val age: Int? = null
)

fun main(args: Array<String>) {
    val people = listOf(Person("Alice"), Person("Bob", age = 42))
*   println("The oldest person is ${people.oldest()}}")
}

private fun List<Person>.oldest() = this.maxBy { it.age ?: 0 }
```

prints
```diff
The oldest person is Person(name=Bob, age=42)}
```
<div class="footnote">
<hr>
<span class="footnote">¹ Adapted from <i>Kotlin in Action</i></span>
</div>

---

template: divider
# Overview

---

# The Beginning

Jul 2011: Announcement

Feb 2016: Release of Kotlin 1.0

Jan 2017: Introduction of Kotlin support in Spring Framework 5.0

May 2017: Google announces First-class support for Android

Jun 2017: Kotlin reaches TIOBE top 50

---

# Kotlin is ...

- statically-typed programming language

- runs on the Java Virtual Machine, Android and the browser (can be compiled to JavaScript source code)

- designed to interoperate with Java code

- tries to avoid boilerplate code as much as possible

- based on Java 6

- Open Source: published under the Apache License, Version 2.0

- actively developed on GitHub: https://github.com/JetBrains/kotlin

- loves contributions (read: accepts pull requests)

---

# Key Features

- Null Safety

- Data Classes

- Extension functions

- Defaulted and named parameters

- Full Java interoperability

---

# Key Features (cont'd)

- Immutability

- Higher-order functions / lambda expressions

- Class delegation

- Delegated properties

- Operator overloading

- Type aliases

- Coroutines

---

template: divider
# Environment Setup

---

# Building with Maven

```xml
<properties>
 <kotlin.version>1.1.3</kotlin.version>
</properties>
```

```xml
<dependencies>
  <dependency>
    <groupId>org.jetbrains.kotlin</groupId>
     <artifactId>kotlin-stdlib</artifactId>
     <version>${kotlin.version}</version>
  </dependency>
</dependencies>
```

```xml
<build>
    <sourceDirectory>src/main/kotlin</sourceDirectory>
    <testSourceDirectory>src/test/kotlin</testSourceDirectory>
    ...
```

---

# Building with Maven (cont'd)

```xml
    <plugins>
        <plugin>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-maven-plugin</artifactId>
            <version>${kotlin.version}</version>
            <executions>
                <execution>
                    <id>compile</id>
                    <phase>compile</phase>
                    <goals><goal>compile</goal></goals>
                </execution>
                <execution>
                    <id>test-compile</id>
                    <phase>test-compile</phase>
                    <goals><goal>test-compile</goal></goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```
*Source: https://kotlinlang.org/docs/reference/using-maven.html*
---

# Building with Gradle

```xml
buildscript {
    ext.kotlin_version = '1.1.3'

    repositories {
        mavenCentral()
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}
```

```groovy
apply plugin: 'kotlin'
```

```groovy
repositories {
    mavenCentral()
}

dependencies {
    compile "org.jetbrains.kotlin:kotlin-stdlib"
}
```

---

# Building with Gradle (cont'd)

** Targeting Java8:**
```groovy
dependencies {
    compile "org.jetbrains.kotlin:kotlin-stdlib-jre8:$kotlin_version"
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
```

*Source: https://kotlinlang.org/docs/reference/using-gradle.html*
---

# IntelliJ IDEA

* Install Kotlin plugin:<br>Preferences → Plugins → Browse repositories... → "Kotlin" → Install

* New Project → Java/Gradle/Maven → Kotlin → ...

* ???

* Profit

---

template: divider
# Basics

---

# Data Types

- Everything is an object, no primitive types

- Kotlin compiler will automatically mal basic types back to JVM primitives when possible

- values must be boxed when type is nullable or when used in generic

```
val int: Int = 42
val long: Long = 42L
val double: Double = 42.17
val float: Float = 42.17F
var hexadecimal: Int = 0xFF
var binary: Int = 0b010101
val isTrue: Boolean = 42 > 17
val character: Char = 'c'
val string: String = "this is a sentence"
val rawString: String = """{ "key": "value" }"""
val array: Array<Int> = arrayOf(17, 42)
```

---

count: false

# Data Types

- Everything is an object, no primitive types

- Kotlin compiler will automatically mal basic types back to JVM primitives when possible

- values must be boxed when type is nullable or when used in generic

```
val int: `Int` = 42
val long: `Long` = 42L
val double: `Double` = 42.17
val float: `Float` = 42.17F
var hexadecimal: `Int` = 0xFF
var binary: `Int` = 0b010101
val isTrue: `Boolean` = 42 > 17
val character: `Char` = 'c'
val string: `String` = "this is a sentence"
val rawString: `String` = """{ "key": "value" }"""
val array: `Array<Int>` = arrayOf(17, 42)
```

<img src="images/you-dont-say.png" height="100">

---

count: false

# Basic Types

- Everything is an object, no primitive types

- Kotlin compiler will automatically mal basic types back to JVM primitives when possible

- values must be boxed when type is nullable or when used in generic

```
val int = 42
val long = 42L
val double = 42.17
val float = 42.17F
var hexadecimal = 0xFF
var binary = 0b010101
val isTrue = 42 > 17
val character = 'c'
val string = "this is a sentence"
val rawString = """{ "key": "value" }"""
val array = arrayOf(17, 42)
```
<img src="images/nice.gif" height="100" style="vertical-align:middle"> **Type inference!**

---

The language tries to avoid boilerplate code as much as possible so we do not call getters/setters explicitly – we can simply use them using the field notation.
template: divider
# Null Safety

---

class: center, middle

<img src="images/simply-explained-npe.jpg" height="420">

*Source: geek-and-poke.com*

---

# Nullable Types and Non-Null Types

Kotlin distinguishes between nullable references
```
var nullableName: String? = "Kotlin"
nullableName.length // compilation error
nullableName = null
```
and non-null references:

```
var nullSafeName: String = "Kotlin"
nullSafeName.length // guaranteed to not cause an NPE
nullSafeName = null // compilation error
```

---

# Safe Calls

**Safe Call Operator**

```
val length = name?.length
```
is equivalent to
```
val length: Int? = if (name != null) name.length else null
```

**Execute if not null**

```
name?.let {
    ... // execute this block if not null
}
```
---

# Safe Calls (cont'd)

**Safe calls chain**

```
val length: Int`?` = company?.department?.team?.name?.length
```
Validates to null if any element of the chain is not null.

In Java:
```java
Integer length = null;
if (company != null) {
    if (company.department != null) {
        if (company.department.team != null) {
            length = company.department.team.name.length();
        }
    }
}
```

---

# Smart Casts

**Java**
```java
if (maybeString instance String) {
  String str = (String) maybeString;
  System.out.println(str)
}
```

**Kotlin**
```
if (maybeString is String) {
  println(maybeString.length)
}
```

The Kotlin compiler can infer that once inside the if block the maybe string is indeed a string and performs the cast for us


---

# Operators

**Elvis Operator**

```
val length = if (name != null) name.length else -1
```
can be shortened to:
```
val length: `Int` = name?.length ?: -1;
```

<br>
**!! Operator** ("non-null asserted")

```
val length = name!!.length
```
`name!!` validates to non-null value of `name` if `name` is non-null and
throws an NPE otherwise

---

template: divider
# Data Classes

---

# Data Classes

```
​​​​`data` class Person(
        val name: String,
        var age: Int? = null
)
```

The Kotlin compiler automatically generates universal methods from all
properties declared in the primary constructor:
- `equals()`
- `hashCode()`
- `toString()`
- `componentN` functions (enables usage in *destructuring declarations*)
- `copy()`

---

template: divider
# Extension Functions

---

# The Java Way

```java
public class StringUtils {

    public static boolean isPalindrom(String s) {
        return s.length() > 0 &&
          s.equals(new StringBuilder(s).reverse().toString());
    }

}
```
```java
StringUtils.isPalindrom("anna")
```

---

# Kotlin to the Rescue

```
fun String.isPalindrom() = this.isNotEmpty() && this == this.reversed()
```

*`isNotEmpty` and `reversed()` are extension functions provided by the Kotlin Standard Library.*

Usage:
```
"otto".isPalindrom()
```

---

count: false
# Kotlin to the Rescue

```
fun String.isPalindrom() = this.isNotEmpty() && this == this.reversed()
```

*`isNotEmpty` and `reversed()` are extension functions provided by the Kotlin Standard Library.*

Usage:
```
"otto".isPalindrom()
```

<div style="text-align: center">
<img src="images/feels-good-man.png" height="240"><br>
<i>Feels Good</i>
</div>

---

# Calling Extension Functions from Java

No magic.

Extension functions are compiled to static functions.

An extension function declared in a Kotlin source file `StringExtensions.kt`
is accessible as a static method in the Java class `StringExtensionsKt`:
```java
StringExtensionsKt.isPalindrom("otto");
```

---

template: divider

# Delegation

---

# Task

Create a class that holds a string. Its `toString()` method returns
said string in lowercase:

```
LowerCase("Kotlin").toString() == "kotlin"
```

<p>&nbsp;</p>
*Lame example, please bear with me...*

*The point is: We want to delegate most of the function calls directy to the given
object and only customize a few methods.*

---

# Class Delegation

(Object) Composition over inheritance: alternative to implementation inheritance

<div style="text-align: center">
<img src="images/delegation.jpg" height="300"><br>
<i>Source: http://best-practice-software-engineering.ifs.tuwien.ac.at</i>
</div>

---

# Class Delegation in Java

```java
public class LowerCaseString implements CharSequence {

   private final String str;

   public LowerCaseString(String str) { this.str = str; }

   public String toString() { return str.toLowerCase(); }

   public int length() { return str.length(); }

   public char charAt(int index) { return str.charAt(index); }

   public CharSequence subSequence(int startIndex, int endIndex) {
      return str.subSequence(startIndex, endIndex);
   }
}
```

---

# Class Delegation in Java

```java
public class LowerCaseString implements CharSequence {

   private final String str;

   public LowerCaseString(String str) { this.str = str; }

   `public String toString() { return str.toLowerCase(); }`

   public int length() { return str.length(); }

   public char charAt(int index) { return str.charAt(index); }

   public CharSequence subSequence(int startIndex, int endIndex) {
      return str.subSequence(startIndex, endIndex);
   }
}
```

<span style="background: #F9F8A5">Implementation of Task</span>

---

# Class Delegation in Java

```java
public class LowerCaseString implements CharSequence {

   private final String str;

   public LowerCaseString(String str) { this.str = str; }

   public String toString() { return str.toLowerCase(); }

   public char charAt(int index) { return Character.toLowerCase(str.charAt(index)); }

   `public int length() { return str.length(); }`

   `public CharSequence subSequence(int startIndex, int endIndex) {`
   `  return str.subSequence(startIndex, endIndex);`
   `}`
}
```

<span style="background: #F9F8A5">Boilerplate</span>

---


# Class Delegation in Kotlin

```
class LowerCaseString(val str: String) : CharSequence by str {

    override fun toString() = str.toLowerCase()

    override fun get(index: Int) = str.get(index).toLowerCase()

}
```

The `LowerCaseString` class inherits from the `CharSequence` interface and
 delegates all of its public, non-overwritten methods to the `string` object.

---

# Class Delegation in Kotlin

```
class LowerCaseString(val `str`: String) : CharSequence by `str` {

    override fun toString(): String {
        return `str`.toLowerCase()
    }

}
```

The `LowerCaseString` class inherits from the `CharSequence` interface and
 delegates all of its public, non-overwritten methods to the `string` object.

---

template: divider

# Delegated Properties

---
# Delegated Properties

Syntax:
```
val/var <property name>: <Type> by <expression>
```
e.g.
```
class Example {
    val str: String by Delegate()
}
```

Standard delegates:
- lazy property: value is only computed upon first access
- observable property: listeners get notified about changes to this property
- storing properties in a map, instead of a separate field for each property

---

# Delegated Properties

Syntax:
```
val/var <property name>: <Type> by <expression>
```
e.g.
```
class Example {
    var str: String by Delegate()
}
```

Standard delegates:
- <span style="background: #F9F8A5">lazy property: value is only computed upon first access</span>
- observable property: listeners get notified about changes to this property
- vetoable property: intercept assignment and block modification
- storing properties in a map, instead of a separate field for each property

... or write your own *custom* property delegate!

---

# Lazy property

Heavy objects may affect application startup time and actually never be called.

```
class StringCache {

    val cachedString by lazy {
        expensiveComputation()
    }

    private fun expensiveComputation(): String {
      ...
    }

}
```

The evaluation of lazy properties is *synchronized* by default.

---

template: divider

# Misc

---

# Other differences to Java

- All exceptions are unchecked

- constructor is treated the same as a normal function, no new keyword

- `==` translate to `equals` and is null safe

 - `assertThat("Kotlin", equalTo("Kotlin"))`

- `if ... else` and `try ... catch` are expressions - their result can be assigned to a value
 -
```
 val maybe = if (Math.random() < 0.5) "Yay!" else "Nay!"
```

- Classes are final by default

---

# Things I skipped

- Packages

- When expression

- Nested Classes

- Enum Classes

- Ranges

- Reflection

- Annotations

---

# Learning Resources

- Kotlin Reference: https://kotlinlang.org/docs/reference/

- Kotlin Koans: https://try.kotlinlang.org/

- <img align="top" src="images/kotlin-in-action.jpg" height="160"><br>*Kotlin in Action* by Dmitry Jemerov and Svetlana Isakova 

- Java Top Blogs: https://www.topjavablogs.com/

- Exercism: http://exercism.io/languages/kotlin/exercises

- Handy Resources to Learn Kotlin Easily: http://blog.rahulchowdhury.co/handy-resources-to-learn-kotlin-easily/

---

# Conclusion

<div style="text-align: center">
<img src="images/which-is-nice.jpg" height="380">
</div>

---

template: divider
# Thank you!


<!-- CONTEND END -->
</textarea>
<script src="remark.js" type="text/javascript">
</script>
<script type="text/javascript">
  var slideshow = remark.create({
    ratio: '16:10',
    highlightLanguage: 'kotlin',
    highlightStyle: 'idea',
    highlightLines: true,
    highlightSpans: true,
    navigation: {
      scroll: false  // disable nagivation using scroll
    }
  });
</script>
<script src="remark-zoom.js" type="text/javascript"></script>
</body>
</html>
